version: 2.1
commands:
  hello-from-env:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: echo "Hello ${VAR}"
  hello-from-context:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: echo "Hello ${VARC}"
  hello-from-both:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: echo "Hello ${VAR}"

jobs:
  from-env:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-env
  from-context:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-context
  from-both:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-both

workflows:
  from-env:
    jobs:
      - from-env:
          filters:
            branches:
              only: /^main$/
  from-context:
    jobs:
      - from-context:
          filters:
            branches:
              only: /^main$/
          context: mycontext
  from-both:
    jobs:
      - from-both:
          filters:
            branches:
              only: /^main$/
          context: mycontext
