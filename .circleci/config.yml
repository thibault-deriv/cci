version: 2.1
commands:
  hello-from-env:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: if [ "${VAR}" = "VAR_FROM_ENV" ]; then echo "ENV"; fi
  hello-from-context:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: if [ "${VARC}" = "VAR_FROM_CONTEXT" ]; then echo "CONTEXT"; fi
  hello-from-both:
    description: "Say hello"
    steps:
      - run:
          name: "Say hello"
          command: if [ "${VAR}" = "VAR_FROM_CONTEXT" ]; then echo "ENV"; fi

jobs:
  from-env:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-env
  from-context:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-context
  from-both:
    docker:
      - image: cimg/node:18.4.0
    steps:
      - checkout
      - hello-from-both

workflows:
  from-env:
    jobs:
      - from-env:
          filters:
            branches:
              only: /^main$/
  from-context:
    jobs:
      - from-context:
          filters:
            branches:
              only: /^main$/
          context: mycontext
  from-both:
    jobs:
      - from-both:
          filters:
            branches:
              only: /^main$/
          context: mycontext



